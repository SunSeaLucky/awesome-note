---
title: VSCode 个性化配置
date: 2025-11-24 00:00:01 +0800
categories: [科研, VSCode]
tags: [vscode, research]     # TAG names should always be lowercase
---

## 背景介绍

大多数人科研面临的情况都是缺显卡，好不容易求爷爷告奶奶借来的服务器，却难以使用。借来的服务器通常满足以下条件：

1. 不是裸金属服务器，他们通常是一个容器环境，往往无法使用 docker
2. 没有自己的账号，你只能使用 A 的账号，你还发现，有 n 个人和你一起用 A 的账号

这通常带来了以下问题：

1. 杂乱的环境变量
2. 共用的 `.vscode-server` 目录，n 个人装了 n 个不同的 LLM 插件，你看着 VSCode 拓展面板里的 Augment、WindSurf、CodeX、Cline、Roo Code、Kilo Code 陷入沉思
3. 共享的家目录。我花钱买的 CC / Codex 总不能让别人随便用吧？

我简称以上情况为下水道式科研。

## 如何解决

### `.vscode-server` 目录问题

1. 首先，选择一个目录，作为你的家目录，可以是 `/home/A/<your_name>`。
2. 修改 `.vscode-server` 的位置，在本机的 VSCode `settings.json` 文件中添加以下内容：

```json
{
    "remote.SSH.serverInstallPath": {
        "<host_name>": "/home/A/<your_name>",
    },
}
```

3. 按下 Ctrl+Shift+P，搜索 `Remote-SSH: Kill Current VS Code server`，选择并杀死服务器上正在运行的 `.vscode-server` 相关进程。
4. 服务器自动重连，问题解决

### 共享家目录和环境变量问题

解决这些问题的最好方式是使用 zsh。
1. 打开一个服务器终端，导出 `$HOME=/home/A/<your_name>`，安装 zsh（默认安装到 `~/.local/bin`）：

```bash
sh -c "$(curl -fsSL https://raw.githubusercontent.com/romkatv/zsh-bin/master/install)"
```

2. 安装 OhMyZsh：

```bash
CHSH=no RUNZSH=no sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
```

3. 在 VSCode **远程服务器**上的 `settings.json` 文件中添加以下内容：

```json
{
    "terminal.integrated.profiles.linux": {
        "zsh": {
            "path": "/usr/bin/env",
            "args": [
                "HOME=/home/A/<your_name>",
                "ZDOTDIR=/home/A/<your_name>",
                "/home/A/<your_name>/.local/bin/zsh",
                "-l"
            ],
        }
    },
    "terminal.integrated.defaultProfile.linux": "zsh",
}
```

4. (可选) 安装 Powerlevel10k 主题：

```bash
git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k
```

找到 ZSH_THEME="robbyrussell" 这一行，修改为：

```bash
ZSH_THEME="powerlevel10k/powerlevel10k"
```

## 总结

配置好这些之后，环境变量不会再从原来的 .bashrc 中继承了。这些操作也完全没有干扰使用此服务器的他人，但用起来好像给自己新开了一个账号一样。祝愿大家早日摆脱下水道式科研。